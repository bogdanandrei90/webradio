<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Web Radio Player</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json" />
  
  <!-- iOS Meta Tags -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Radio" />
  <link rel="apple-touch-icon" href="https://via.placeholder.com/180x180/1db954/000000?text=Radio" />
  
  <!-- Theme Colors -->
  <meta name="theme-color" content="#1c1c1c" />

  <style>
    :root {
      --bg-primary: #111;
      --bg-secondary: #1c1c1c;
      --bg-tertiary: #222;
      --bg-button: #333;
      --bg-button-sort: #555;
      --text-primary: #fff;
      --text-secondary: #aaa;
      --text-tertiary: #888;
      --accent: #1db954;
    }

    body.day-mode {
      --bg-primary: #f5f5f5;
      --bg-secondary: #ffffff;
      --bg-tertiary: #e8e8e8;
      --bg-button: #d0d0d0;
      --bg-button-sort: #b0b0b0;
      --text-primary: #000;
      --text-secondary: #555;
      --text-tertiary: #777;
      --accent: #1db954;
    }

    body {
      font-family: Arial, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      transition: background 0.3s, color 0.3s;
    }

    .radio {
      background: var(--bg-secondary);
      padding: 20px;
      border-radius: 12px;
      width: 320px;
      text-align: center;
      transition: background 0.3s;
    }

    h2 {
      margin-bottom: 15px;
    }

    input[type="text"] {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
      border-radius: 6px;
      border: none;
      background: var(--bg-tertiary);
      color: var(--text-primary);
    }

    button {
      padding: 10px 14px;
      margin: 5px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
    }

    .play {
      background: #1db954;
      color: #000;
    }

    .pause {
      background: #ff4d4d;
      color: #000;
    }

    .theme-toggle {
      background: var(--bg-button-sort);
      color: var(--text-primary);
      font-size: 20px;
      padding: 8px 12px;
      margin-left: 10px;
    }

    .preset {
      background: var(--bg-button);
      color: var(--text-primary);
      width: 100%;
      margin-top: 6px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      text-align: left;
      transition: background 0.3s;
    }

    .genre-badge {
      background: var(--bg-button-sort);
      color: var(--text-secondary);
      font-size: 10px;
      padding: 3px 8px;
      border-radius: 4px;
      margin-left: 8px;
      white-space: nowrap;
    }

    .sort {
      background: var(--bg-button-sort);
      color: var(--text-primary);
      font-size: 12px;
      padding: 6px 10px;
    }

    .volume {
      margin-top: 15px;
      text-align: left;
    }

    .volume input {
      width: 100%;
    }

    .loading {
      margin-top: 10px;
      font-size: 13px;
      color: var(--text-secondary);
      display: none;
    }

    .flag-icon {
      width: 20px;
      height: 15px;
      margin-right: 8px;
      vertical-align: middle;
    }

    .now-playing {
      background: var(--bg-tertiary);
      padding: 12px;
      border-radius: 8px;
      margin-top: 15px;
      text-align: left;
      display: none;
      transition: background 0.3s;
    }

    .now-playing h4 {
      margin: 0 0 8px 0;
      font-size: 12px;
      color: var(--text-tertiary);
      text-transform: uppercase;
    }

    .now-playing .track {
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 4px;
    }

    .now-playing .artist {
      font-size: 14px;
      color: var(--text-secondary);
    }

    .elapsed-time {
      font-size: 12px;
      color: var(--text-tertiary);
      margin-top: 8px;
    }

    .equalizer {
      display: inline-flex;
      align-items: flex-end;
      height: 16px;
      gap: 2px;
      margin-right: 8px;
    }

    .equalizer span {
      width: 3px;
      background: var(--accent);
      animation: equalize 1s ease-in-out infinite;
    }

    .equalizer span:nth-child(1) { animation-delay: 0s; }
    .equalizer span:nth-child(2) { animation-delay: 0.2s; }
    .equalizer span:nth-child(3) { animation-delay: 0.4s; }
    .equalizer span:nth-child(4) { animation-delay: 0.6s; }

    @keyframes equalize {
      0%, 100% { height: 4px; }
      50% { height: 16px; }
    }
  </style>
</head>
<body>

<div class="radio">
  <h2>Web Radio <button class="theme-toggle" onclick="toggleTheme()" id="themeToggle">üåô</button></h2>

  <!-- Stream URL -->
  <input
    type="text"
    id="streamUrl"
    placeholder="Paste radio stream URL"
  />

  <!-- Play / Pause -->
  <div>
    <button class="play" onclick="playRadio()">‚ñ∂ Play</button>
    <button class="pause" onclick="pauseRadio()">‚è∏ Pause</button>
  </div>

  <!-- Loading indicator -->
  <div class="loading" id="loading">
    Loading stream...
  </div>

  <!-- Now Playing -->
  <div class="now-playing" id="nowPlaying">
    <h4>Now Playing</h4>
    <div class="track" id="trackTitle">
      <div class="equalizer" id="equalizer">
        <span></span><span></span><span></span><span></span>
      </div>
      <span id="stationName">-</span>
    </div>
    <div class="artist" id="artistName">-</div>
    <div class="elapsed-time" id="elapsedTime">0:00</div>
  </div>

  <!-- Volume -->
  <div class="volume">
    <label>Volume</label>
    <input
      type="range"
      min="0"
      max="1"
      step="0.01"
      value="0.7"
      oninput="setVolume(this.value)"
    />
  </div>

  <!-- Presets -->
  <h3 style="margin-top: 15px;">Presets</h3>

  <div id="presets-container">
  <button class="preset" data-genre="Pop" onclick="playPreset('https://megastar-cope.flumotion.com/playlist.m3u8', 'MegaStar FM')">
    <span><img src="https://flagcdn.com/w20/es.png" class="flag-icon" alt="Spain"> MegaStar FM</span>
    <span class="genre-badge">Pop</span>
  </button>

  <button class="preset" data-genre="Dance" onclick="playPreset('https://edge126.rcs-rds.ro/profm/dancefm.mp3', 'Dance FM')">
    <span><img src="https://flagcdn.com/w20/ro.png" class="flag-icon" alt="Romania"> Dance FM</span>
    <span class="genre-badge">Dance</span>
  </button>

  <button class="preset" data-genre="Alternative" onclick="playPreset('https://s7.yesstreaming.net/stream/8000', 'Off Radio')">
    <span><img src="https://flagcdn.com/w20/gr.png" class="flag-icon" alt="Greece"> Off Radio</span>
    <span class="genre-badge">Alternative</span>
  </button>

  <button class="preset" data-genre="Pop" onclick="playPreset('https://media-ssl.musicradio.com/Capital', 'Capital FM')">
    <span><img src="https://flagcdn.com/w20/gb.png" class="flag-icon" alt="UK"> Capital FM</span>
    <span class="genre-badge">Pop</span>
  </button>

  <button class="preset" data-genre="Smooth" onclick="playPreset('https://smooth.vanillaradio.com:8032/live', 'Smooth Radio')">
    <span><img src="https://flagcdn.com/w20/gr.png" class="flag-icon" alt="Vaniila Radio - Smooth"> Vanilla - Smooth Radio</span>
    <span class="genre-badge">Smooth</span>
  </button>

  <button class="preset" data-genre="Deep House" onclick="playPreset('https://stream.vanillaradio.com:8016/stream/stream', 'Vanilla Radio')">
    <span><img src="https://flagcdn.com/w20/gr.png" class="flag-icon" alt="Vanilla Radio - Deep"> Vanilla - Deep Radio</span>
    <span class="genre-badge">Deep House</span>
  </button>

  <button class="preset" data-genre="Variety" onclick="playPreset('https://s1-webradio.antenne.de/antenne/stream/aacp', 'Antenne Bayern')">
    <span><img src="https://flagcdn.com/w20/de.png" class="flag-icon" alt="Antenne Bayern"> Antenne Bayern</span>
    <span class="genre-badge">Variety</span>
  </button>
  </div>

  <audio id="audio"></audio>
</div>

<script>
  const audio = document.getElementById("audio");
  const loading = document.getElementById("loading");
  const streamInput = document.getElementById("streamUrl");
  const nowPlaying = document.getElementById("nowPlaying");
  const stationName = document.getElementById("stationName");
  const artistName = document.getElementById("artistName");
  const equalizer = document.getElementById("equalizer");
  const elapsedTime = document.getElementById("elapsedTime");

  audio.volume = 0.7;
  let startTime = null;
  let timerInterval = null;

  // Theme toggling
  function toggleTheme() {
    const body = document.body;
    const themeToggle = document.getElementById('themeToggle');
    body.classList.toggle('day-mode');
    
    if (body.classList.contains('day-mode')) {
      themeToggle.textContent = '‚òÄÔ∏è';
      localStorage.setItem('theme', 'day');
    } else {
      themeToggle.textContent = 'üåô';
      localStorage.setItem('theme', 'night');
    }
  }

  // Auto-detect time-based theme on load
  function initTheme() {
    const savedTheme = localStorage.getItem('theme');
    const hour = new Date().getHours();
    const themeToggle = document.getElementById('themeToggle');
    
    if (savedTheme === 'day' || (!savedTheme && hour >= 6 && hour < 18)) {
      document.body.classList.add('day-mode');
      themeToggle.textContent = '‚òÄÔ∏è';
    } else {
      themeToggle.textContent = 'üåô';
    }
  }

  // Initialize theme on page load
  initTheme();

  // Update elapsed time
  function updateElapsedTime() {
    if (!startTime) return;
    const elapsed = Math.floor((Date.now() - startTime) / 1000);
    const minutes = Math.floor(elapsed / 60);
    const seconds = elapsed % 60;
    elapsedTime.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
  }

  // Start timer
  function startTimer() {
    startTime = Date.now();
    if (timerInterval) clearInterval(timerInterval);
    timerInterval = setInterval(updateElapsedTime, 1000);
    updateElapsedTime();
  }

  // Stop timer
  function stopTimer() {
    if (timerInterval) {
      clearInterval(timerInterval);
      timerInterval = null;
    }
    startTime = null;
    elapsedTime.textContent = "0:00";
  }

  // Show Now Playing with station name and equalizer
  function showNowPlaying(station) {
    equalizer.style.display = "inline-flex";
    stationName.textContent = station || "Web Radio";
    artistName.style.display = "none"; // Hide the artist line
    nowPlaying.style.display = "block";
    startTimer();
  }

  function playRadio() {
    const url = streamInput.value.trim();
    if (!url) {
      alert("Please enter a stream URL");
      return;
    }

    if (audio.src !== url) {
      audio.src = url;
    }

    loading.style.display = "block";

    audio.play().catch(() => {
      loading.style.display = "none";
      alert("Unable to play this stream.");
    });
  }

  function pauseRadio() {
    audio.pause();
    loading.style.display = "none";
    stopTimer();
  }

  function setVolume(value) {
    audio.volume = value;
  }

  function playPreset(url, stationDisplayName) {
    streamInput.value = url;
    showNowPlaying(stationDisplayName || "Web Radio");
    playRadio();
  }

  audio.addEventListener("playing", () => {
    loading.style.display = "none";
  });

  audio.addEventListener("waiting", () => {
    loading.style.display = "block";
  });

  audio.addEventListener("error", () => {
    loading.style.display = "none";
    alert("Stream error.");
  });

  // Register Service Worker for PWA
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js')
      .then(() => console.log('Service Worker registered'))
      .catch(err => console.log('Service Worker registration failed:', err));
  }
</script>

</body>
</html>
